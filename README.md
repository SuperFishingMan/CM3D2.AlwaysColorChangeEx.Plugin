# CM3D2.AlwaysColorChange.Plugin
パーツごとに好きに色変更できるようにするプラグインです。  
まだ実験段階です。  
**New!** 暫定的にmenu/mate出力できるようになりました。

## 導入方法
#### 前提条件  
UnityInjectorが導入済みであること。

#### インストール  
Download ZIPボタンを押してzipファイルをダウンロードします。  
zipファイルの中にあるUnityInjectorフォルダを、CM3D2フォルダにコピーしてください。

#### 自分でコンパイルする場合  
自分でコンパイルする場合、UnityInjectorフォルダにソース（**CM3D2.SubScreenPlugin.cs**）をコピーした後、コマンドプロンプト等で  
`cd [UnityInjectorフォルダ]`
`C:\Windows\Microsoft.NET\Framework\v3.5\csc /t:library /lib:..\CM3D2x64_Data\Managed /r:UnityEngine.dll /r:UnityInjector.dll /r:Assembly-CSharp.dll /r:Assembly-CSharp-firstpass.dll /r:ExIni.dll CM3D2.AlwaysColorChangePlugin.cs`  
を実行してください。

## 機能概要
#### 対象シーン
* エディット
* 夜伽
* ダンス
* ADVパート

で動作する（はず）です。

#### 使用方法
###### メニュー操作
F12キーでメニューが開きます。  
キーアサインを変更したい場合は、ソースを編集・コンパイルしてください。  

![GUI](http://i.imgur.com/sMm5lo9.jpg  "GUI")

パーツを選択し、RGBAをスライダーで変更後、適用ボタンで色が変更されるはずです。  
パーツの元の色によっては変わらないかもしれません。  
Aを1未満にすると、無理やりTransシェーダーを適用して透過します。  

###### 機能説明
* マスククリア  
  maskItemで消去されているアイテムをすべて表示します。  
  表示後は、個別にα値変更で不要なものを消してください。
* ノード表示切り替え  
  ノード（身体の部位）の表示・非表示を切り替えられます。  
  適用ボタンで反映。
* 保存  
  現在の衣装・設定値をプリセットとして保存します。  
  プリセット適用で呼び出すことがます。  
  - マスククリアを有効にする  
    プリセット適用時、マスククリアを適用するようにします。
  - 身体も保存する  
    髪型・顔等も保存します。（プリセットの服／体と同等）
* プリセット適用  
  保存したプリセットを選択・適用します。
* menu/mate保存
  現在のスロットの設定値をmenu/mateファイルに出力します。  

###### menu/mate保存の仕様について
現在は以下のような仕様となっています。
* 保存先  
  Mod/ACC以下（標準Modで読み込めます）
* ファイル名  
  保存ダイアログが開くので、そこでファイル名等変更します。  
  既に同名のメニューおよびマテリアルファイルが存在する場合、保存できません。  
  アイコン・モデルファイルは別で、変更がなければそのまま、変更した場合は変更したファイル名でコピーして保存します。  
  適宜コピーしたファイルを編集してください。
  ※標準Modがパス関係なく読み込めるので、種類ごとにフォルダ分けしません。
* priority  
  9999としているので、各カテゴリの後ろのほうに追加されると思います。  
* わかっていること
  - freeカラー対応の素材（髪、肌等）は非対応  
    もともと変更できるのだから、不要かと・・・
  - αは元々透過対応シェーダーのものしか効かない  
    非対応に適用するにはmodelも変更する必要がある＆maskItem・node消去もあわせてやらないと・・・  
	仕組み的には実装可能なので、今後できれば。
  - .modには非対応  
    .modのフォーマット自体まだまだ変わりそうなので様子見かな・・・

  他にも不具合あるかもしれません。

#### 今後やりたいこと  
できればいいな、であり、実装できるとは限りません。
* maskItemやnode消去を自由に操作（暫定対応）
* パーツ変更を認識して自動適用
* テクスチャ差し替え
* 複数メイド対応
* GUIをなんとかしたい・・・

#### 権利とか？
ソースの改変・再配布等は自由にしていただいてかまいません。  
むしろやりたいこと・それを超える機能を実装してくれる人歓迎。

##更新履歴
####0.0.3.4
* menu書き換え不具合修正

####0.0.3.2
* menu/mate出力時、Modelもコピーするように

####0.0.3.1
* menu/mate出力時、ファイル名・名前・説明等変更できるように

####0.0.3.0
* menu/mate出力に暫定対応

####0.0.2.5
* Shadow, Rim, Outline, Shininessも変更可能に

####0.0.2.0
* プリセット保存・読み込みできるように

####0.0.1.0
* maskItemで非表示になっているアイテムを全部表示できるように
* node消去を部位別に切り替えできるように

####0.0.0.2
* マテリアルごとに色変更できるように
* 適用ボタンを押さなくてもスライダー変更でリアルタイムに適用

####0.0.0.1
* 初版（実験版）
